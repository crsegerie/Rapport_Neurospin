\chapter*{The neuroanatomical signature of time in Working Memory}

% Il m'a fallu un temps conséquent pour me former au début du stage à l'analyse en EEG. 
% Au MVA, j'avais déjà fait des neurosciences, ainsi que la théorie physique des EEG et MEG à l'aide du cours d' \href{http://math.ens-paris-saclay.fr/version-francaise/formations/master-mva/contenus-/imagerie-fonctionnelle-cerebrale-et-interface-cerveau-machine-161979.kjsp?RH=1242430202531}{Imagerie fonctionnelle cérébrale et interface cerveau machine}, au cours duquel j'ai déjà manipulé les interfaces cerveau machines par exemple en
% \href{https://github.com/crsegerie/bci_competition}{réimplémentant} la solution des vainqueurs de la compétition \href{https://www.kaggle.com/c/inria-bci-challenge}{inria-bci-challenge}. Mais en réalité, lors de cette compétition kaggle, les participants ont été épargnés du préprocessing du traitement de la donnée des EEG : les organisateurs du kaggle avaient déjà nettoyé la donnée qui était alors utilisable par n'importe quel praticien en machine learning. Mais il existe tout un savoir faire afin de nettoyer la donnée, et ce nettoyage et cette analyse est presque plus technique que du machine learning conventionnel.



% \begin{comment}
% \section{Théorie}
% voir le cours de gramfort. Voir le cours du mva.
% \section{L'écosysteme MNE - Bids}
% \subsection{mne-python}
% \subsection{mne-bids-pipeline}
% \subsection{mne-bids}
% \end{comment}

\section{Prélude}

J'ai séparé ce rapport en deux parties qui suivent grossièremetnt l'ordre chronologiqe de mon stage.

Le premier chapitre donne le contexte scientifique de mon stage. Cete partie ne consitutue pas compte rendu de mon travail mais plutot de l'environnement dans lequel je m'inserre et des connaissances prerequises pour comprendre par la suite mon travail. L'activité scientifique n'est plus une activité solitaire, surtout en neuroscience, ou les outils utilisés reposent dsur des années de travail collectifs. Cette partie rend donc hommage au épaules de géants ssur lesquelles je me suis basé pendant mon stage. J'explique notemment dans ce chapitre les tenant et aboutissants du papier sémin al/ Pilot study sur lequel je me repose \cite{herbst2021abstracting}. Mais ce papier initial ne permettait pas de voir en détail la structure du cerveau pendant l'accomplissaement de la tache. Ce chapitre pourrait consitituer l'introduction d'un papier publié à la suite de ce stage.

Le second chapitre est une exposition de mon travail. J'y expose en détail la reproduction du papier séminal : "Abstracting time in Working Memory" de Sophie Herbst en utilisant cette fois ci la MEG. Nous avons reproduit les résultat de la Pilot study mais en utilisant l'imagerie par MEG afin d'analyser les parties du cerveau à l'oeuvre lors de l'utilisation de la mémoire de trvail. La MNE-bis -pipeline, qui est une pipeline d'analyse automatique de donnée MEEG consititua le socle de notre analyse. Mais afin de pouvoir réellement analyser la donnée cérébrale, il a fallut adapter la mne-bids-pipeline en utilisant de nouveaux algorithmes afin de répondre aux exigence de notre paradigme experimental. Cette partie pourrait constituer la partie methode, resultats et discussion d'un futur papier.


\chapter{Scientific Context}
Ici mettre tout ce que l'on pouvait deviner avant de faire le stage

\section{Lire la feuille de stage}
This internship combines two aims: to extract the neural signatures of time stored
in working memory from existing MEG data, and to contribute to ongoing efforts of
establishing an open-science pipeline for MEG analysis in BIDS (standardized brain imaging
data format, \cite{gorgolewski2016brain}). The project is part of a collaboration between NeuroSpin, and the MNE
Python developers at Inria (Alexandre Gramfort), with the aim to push the use of BIDS for
more transparent and open MEEG research practices.

As shown by a large number of studies, humans (and animals) can perceive
temporal intervals (durations in the range of seconds), judge or compare them with other
intervals, and recognize or reproduce them later on. Hence, durations can be stored in
memory, like sensory stimuli. It is however not known yet how the brain achieves this, for
instance in which format (continuous or symbolic) durations are stored and which brain
mechanisms support this crucial ability \cite{polti2018effect}, \cite{teki2014working}. In this internship, you will join the team in the
ongoing analysis of the previously collected MEG based on a working memory paradigm,
with the aim to reconstruct source time courses of brain activity from the cortex, and
possibly the hippocampus and cerebellum \cite{gauthier2020hippocampal}(using volume source models in MNE-Python.

The pipeline developed during the project will contribute to ongoing open-science
efforts by the team to establish a robust and publicly available pipeline for source
reconstruction of MEEG data based on the BIDS MEG data format in MNE-Python.


% Why this stage
% Mes connaissances préalables: MVA cours imagerie fonctionnelel cerebrale + Neuroscience + imagerie médiacle
% L'environnement : les différentes équipes

% Les equipes
% - Inria Parietal 
% - Neurospin, Cognition and Brain dynamics.

\section{EEG, MEG}

EEG (electroencephalography) end MEG measures the electrical activity of our brain via electrodes that are placed on the scalp. It tells us, from the surface measurements, how active the brain is.

Pour notre paradigme, il est bien plus important d'avoir une grande precesion temporelle, nous avons donc choisi d'utiliser les MEG de neurospin [image neurospin MEG], qui sont parmis les seuls MEG en France.


% http://meg-france.in2p3.fr/_lesCentres/Neurospin_en.php
The MEG lab is part of NeuroSpin, a neuroimaging center located on the campus of Saclay. We are part of the Comissariat à l'Energie Atomique (CEA), the Division of Life Sciences (DSV) and the Institute of BioImaging (I2BM) as well as the INSERM Cognitive Neuroimaging Unit.

Equipment
The MEG at Neurospin is an Elekta Neuromag 306 sensors whole-head device (details). The MEG helmet consists of 102 sensors-triplets (1 triplet = 2 orthogonal planar gradiometers and 1 magnetometer).



How does EEG work?
The brain is an electrical system – all of our thoughts (conscious or otherwise) are generated through a network of neurons, that send signals to each other with the help of electrical currents. The more electrical signals, the more neuronal communication, which corresponds to more brain activity.

The electrodes of an EEG headset can’t detect changes in single neurons, but instead detect the electrical changes of thousands of neurons signalling at the same time.

The signal from the electrodes is then sent to an amplifier, that (no surprises here) amplifies the signal. A computer then receives this signal, and can generate various maps of brain activity, with a rapid temporal resolution.

A drawback for EEG is the spatial resolution – as the electrodes measure electrical activity at the surface of the brain, it is difficult to know whether the signal was produced near the surface (in the cortex) or from a deeper region.

There are calculations that can be applied that attempt to get around this limitation (e.g. [2]), but it remains a challenge for EEG research.


\subsection{Generalities about MEG data and their preprocessing}

With magnetoencaphalography we can capture the magnetic field created by the electrical cur-
rents in our brain. The MEG data are collected through two types of sensors : the gradiometers and

the magnetometers. The MEG data I am manipulating during the internship are composed of 204
gradiometer channels and 102 magnetometer channels (Figure 1). These MEG data were recorded
trhough three sessions per subjects : one at rest with closed eyes, one passive with separately visual
and auditive stimuli and one with sensorimotor tasks (audio-visual stimuli with manual response)
([Taylor et al., 2017]).


\section{L'écosysteme MNE}


mne-python, bids, mne-bids-pipeline
mne python est une librairie python open-source permettant d'analyser les données cérébrales venant d'EEG ou de MEG. Le format BIds


Theorie
- Les modèles de clocks cerebrales??
- Paradigme de la Pilot study
- Pourquoi EEG plutot que FMRI
- Donner le but du Stage : 
    Reproduire cette study mais avec la MEG
- Glossaire

\chapter{Ma contribution: replication mais avec MEG}

% Setup
% - renvoyer au document de l'ensemble des choses que j'auraient aimés savoir dés le début

% Deux études : 
% - Welcome study
% - Sample

\section{Preprocessing}

\subsection{Bids Pipeline}
- Dataset description
- Raconter la pipeline BIDS, utilité
- Premiereres PR necessité pourquoi ?
    premiere contri open source
    avec une utilité


Tableau des proprocessing

Cheat Cheet
- Limites:
    - Nombre de participants

\section{Sensor Space}

- Pipeline classique raconter les steps
- Motivation : Insuffisance de la pipeline automatique: beoin d'une nouvelle step
- Theorie algo:
    - CSP
    - Permutation tests
    - subtilités mathématiques
    - Ingénieurie logicielle et recherche ?
- Anexes : Implémentation et choix d'architecte logiciel
    - optimisation du temps
        reduction dimensionalité
        reduction du nombre de channels
    - CV, decimation, niquist
    - Interaface avec le reste de la pipeline, openscience, reproductibilité
- Results:
    - Images
- Discussion
    - resultats significatifs alors que dans la tête
- Limites + Discu

\section{Source Space}

- Generalités source space
Nouveau script: Contrast in source space
    - Motivation : Insuffiscance de pipeline classique
    - faire le Schéma
- Results:
    - Interpretation sur Freeview
- Discussion
- Annexes : Subtilité : 
    Neuroscience : quest ce qui constitue du bruit ? Quel choix de la matrice de covariance
    Subtilités mathématiques :  commutativité Log + moyenne
Limites:
    - 





une fois que l'on fini le plan on appelle MM et on lui explique, et on regarde par quoi on commence l'explication +  on enregistre dictaphone